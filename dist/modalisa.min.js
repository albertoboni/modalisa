/*! modalisa v0.2.1 | Alberto Boni | 2015-09-22 */
var Modalisa={modal_selector:"#modalisa-dialog",overlay_selector:"#modalisa-overlay",modal_content_template:'<div class="modalisa-dialog-content">[%content%]</div>',screen_lock:!1,_modal:[],_overlay:[],open:function(a){"object"!=typeof a&&(a={}),this.screen_lock=a.screen_lock?!0:!1,this.width=a.width?a.width:300,this.height=a.height?a.height:"auto",this.top=a.top?a.top:null,a.img_src&&(a.html=$("<img>").attr("src",a.img_src).prop("outerHTML")),this._renderContent(a),this._renderOverlay(a),this._repositionModal(),$(document).keyup(this._closeShortcut)},openAjax:function(a){if(a.url){var b=a.method?a.method:"get",c=a.data?a.data:{},d=this;console.log(a),$.ajax({url:a.url,type:b,dataType:"json",data:c,success:function(b){delete a.url,a.html=b.html,d.open(a)}})}},close:function(a){this.screen_lock||(this._modal.attr("style","").hide(),this._overlay.hide(),$(document).unbind("keyup",this._closeShortcut))},_repositionModal:function(){var a=($(window).height()-this._modal.height())/2;50>a&&(a=50),this._modal.css({"z-index":21,top:(this.top?this.top:$(window).scrollTop()+a)+"px",height:"auto"==this.height?this.height:this.height+"px"}),$("body").innerWidth()>720&&this._modal.css({left:"50%","margin-left":this.width/2*-1+"px"})},_renderContent:function(a){html=a.html?a.html:$(a.html_selector).html(),0==this._modal.length&&($("body").append('<div id="'+this.modal_selector.replace("#","")+'"></div>'),this._modal=$(this.modal_selector)),this._modal.css({display:"block",position:a.position?a.position:"absolute",width:this.width,height:this.height}).empty().append(this.modal_content_template.replace("[%content%]",html))},_renderOverlay:function(a){0==this._overlay.length&&($("body").append('<div id="'+this.overlay_selector.replace("#","")+'"></div>'),this._overlay=$(this.overlay_selector));var b=this;this._overlay.click(function(){b.close()}).css({display:"block",width:"100%",height:"100%",opacity:.6,background:"#000000",position:"fixed",top:0,left:0,"z-index":20})},_closeShortcut:function(a){27==a.keyCode&&Modalisa.close()}};